      FUNCTION ISON( NI , NJ , IND )
C
C     AUXILIARY-LIBRARY-ROUTINE FOR CNTOUR
C  *Modified version for RELAX3D: dimension of IARRAY increased
C   to 16000 to accomodate 500000 grid points.
C
C                                                05/AUG/1980
C                                                C.J. KOST SIN
C  
C     reqd. routines - NONE
C
C
C                  - C A U T I O N  -
C            THIS SUBROUTINE HAS THE TWO MACHINE DEPENDANT
C       FUNCTION SUBPROGRAMS 'AND' AND 'OR' .       IT MAY NOT
C          RUN PROPERLY ON MACHINES OTHER THAN THE IBM 360/67.
C       OR VAX/780
C
C  FOLLOWING DIMENSION OF "IARRAY" MUST BE .GE. NI*NJ/32
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

C     DIMENSION IARRAY( 5000 )
      PARAMETER(NARRAY=16000)
      DIMENSION IARRAY(NARRAY)

      DIMENSION IMASK( 32 )
C      DATA IMASK /X'1', X'2', X'4', X'8', X'10', X'20', X'40', X'80',
C    1 X'100', X'200', X'400', X'800', X'1000', X'2000', X'4000',
C    2 X'8000', X'10000', X'20000', X'40000', X'80000',
C    3 X'100000', X'200000', X'400000', X'800000',
C    4 X'1000000', X'2000000', X'4000000', X'8000000',
C    5 X'10000000', X'20000000', X'40000000', X'80000000' /
       DATA IMASK /1, 2, 4, 8, 16, 32, 64, 128,
     1 256, 512, 1024, 2048, 4096, 8192, 16384,
     2 32768, 65536, 131072, 262144, 524288,
     3 1048576, 2097152, 4194304, 8388608,
     4 16777216, 33554432, 67108864, 134217728,
     5 268435456, 536870912, 1073741824, 2147483648/
      INTEGER TEMP
      EQUIVALENCE(TEMP,ITEMP)
C
C      IF IND =   -1 THEN CLEAR THE ARRAY
C              0 THEN CHECK THE FLAG ONLY
C              +1 THEN CHECK THE FLAG AND SET IT TO 1
C
      IF(IND .NE.(-1)) GO TO 1
      DO I=1,NARRAY
        IARRAY(I) = 0
      ENDDO
      NN = NI
      ISON = 0
      RETURN

1     CONTINUE
      IPOS = ( NJ - 1 ) * NN + NI
      IWORD = IPOS / 32
      IBIT = IPOS - IWORD * 32  + 1
      IWORD = IWORD + 1
      TEMP = IAND( IARRAY( IWORD ) , IMASK( IBIT )  )
      ISON = 1
      IF( IND .EQ. 0 ) GO TO 200
      IF( ITEMP .NE. 0 ) RETURN
      ISON = 0
      TEMP= IEOR(IARRAY(IWORD),IMASK(IBIT))
      IARRAY(IWORD)=ITEMP
      RETURN
200   CONTINUE
      IF( ITEMP .EQ. 0 ) ISON= 0
      RETURN
      END
