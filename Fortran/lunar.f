C *** WRITTEN BY JIM STORER, LEXINGTON HIGHSCHOOL, U.S.
C *** CONVERTED FROM FOCAL TO BASIC BY DAVID AHL, DIGITAL
C *** WRITTEN AND DEBUGGED FOR THE KBASIC BY ANTTI J. YLIKOSKI
C *** HELSINKI, FINLAND, THE E.U, 10-21-2010
C *** THIS WAS WRITTEN FROM A SPAGHETTI PROGRAM, IE. NUMEROUS GOTO'S
C *** COULD HAVE TRANSMUTATED ALL THIS INTO STRUCTURED PROGRAMMING
C *** BUT THAT WOULD HAVE BEEN LOTS OF WORK --
C *** THIS LEGACY PROGRAM DOES WORK AS SUCH.  A. J. Y. 01-30-2010.
C *** From: The Best of Creative Computing Vol1, p.264, ISBN 0-916688-01-1.
C *** Edited by David H. Ahl, Creative Computing Press, PO Box 789-M
C *** Morristown, N.J. 07960.  (C) CREATIVE COMPUTING.
      REAL L, A, V, M, N, G, Z
      REAL K, T, S, I, J, W
      INTEGER I0
      CHARACTER*1 W9String
   15 PRINT*, "LUNAR LANDING SIMULATION"  
      PRINT*
   20 PRINT*
      PRINT*
      PRINT*, "CONTROL CALLING LUNAR MODULE..."
      PRINT*
   35 PRINT*, "YOU MAY SET THE FUEL RATE (K) TO ZERO OR ANY VALUE"
   40 PRINT*, "BETWEEN 8 AND 200 LBS PER SECOND.  A NEGATIVE FUEL"
   50 PRINT*, "RATE WILL ABORT THE MISSION." 
      PRINT*
   60 PRINT*, "YOU HAVE 16000 LBS OF FUEL."
   70 PRINT*, "ESTIMATED FREE FALL IMPACT TIME IS 120 SECONDS."
   80 PRINT*, "CAPSULE WEIGHT IS 32,500 LBS."
   90 PRINT*
      PRINT*, "FIRST RADAR CHECK COMING UP..."
  100 PRINT*, "BEGIN LANDING PROCEDURE" 
      PRINT*
      PRINT*
  102 PRINT*, "PRESS (ENTER) TO START: "
  104 READ*, W9String
  108 CALL SYSTEM('clear')
  110 PRINT*, "TIME(SECS)", "HEIGHT(MI)", " VELOC.(MPH)", " FUEL(LBS)", 
     * " FUEL RATE"
  120 L = 0.0 
      A = 120.0 
      V = 1.0
      M = 32500.0
      N = 16500.0
  170 G = .001
      Z = 1.8
      I = 1.0
  210 PRINT*, INT(L+.5), INT(A), INT(V*3600.0), INT(M-N), "K"
  220 READ*, K
  225 T = 10.0
  230 IF (K.LT.0.0) GOTO 590
  235 IF (K.EQ.0.0) GOTO 310
  240 IF (K.LT.8.0) GOTO 260
  250 IF (K.LE.200.0) GOTO 310
  260 PRINT*, "NOT POSSIBLE","K";
  270 READ*, K
      GOTO 230
  310 IF (M-N-.001 .LE. 0.0) GOTO 410
  320 IF (T.LE..001) GOTO 210
  330 S = T
      IF (N+S*K .LE. M) GOTO 350
  340 S = (M-N)/K
  350 I0 = 1 
      GOTO 900
  360 IF (I .LE. 0.0) GOTO 710 ! REM REMOVED THIS STATEMENT -- EVIDENTLY WRONG!!
  370 IF (V .LE. 0.0) GOTO 380
  375 IF (J.LE.0.0) GOTO 810
  380 I0 = 1
      GOTO 600
  410 PRINT*, "FUEL OUT AT ",L," SECS."
  420 S = (-V + SQRT(V*V+2.0*A*G))/G
  430 V = V+G*S
  440 L = L+S
  510 PRINT*, "ON THE MOON AT ", L, " SECS."
  511 W = 3600.0*V
  514 PRINT*, "IMPACT VELOCITY OF ", W, " M.P.H."
  520 PRINT*, "FUEL LEFT ", INT(M-N), " LBS."
  530 IF (W.GE.1) GOTO 550
  540 PRINT*, "PERFECT LANDING!   CONGRATULATIONS!!"
      GOTO 590
  550 IF (W .GE. 10) GOTO 560
  552 PRINT*, "VERY GOOD LANDING, NOT PERFECT YET."
      GOTO 590
  560 IF (W .GE. 25) GOTO 570
  562 PRINT*, "A FAIR LANDING, NO CRAFT DAMAGE."
      GOTO 590
  570 IF (W .GE. 60) GOTO 580
  572 PRINT*, "CRAFT DAMAGE.  HOPE YOUR OXYGEN HOLDS OUT UNTIL A"
  574 PRINT*, "RESCUE MISSION ARRIVES!"
      GOTO 590
  580 PRINT*, "SORRY, BUT THERE WERE NO SURVIVORS."
  585 PRINT*, "IF FACT YOU BLASTED A NEW LUNAR CRATER ", W*.277777, 
     *        " FEET DEEP."
  590 PRINT*
      PRINT*
      PRINT*, "TRY AGAIN (1 FOR YES, 0 FOR NO)"
  592 READ*, R 
      IF (R.EQ.1) THEN 
      GOTO 90 
      ELSE IF (R.EQ.0) THEN 
      GOTO 595 
      ELSE 
      GOTO 590
      ENDIF
  595 PRINT*
      PRINT*, "CONTROL OUT" 
      GOTO 9999
  600 L=L+S
  610 T=T-S
  620 M=M-S*K
  630 A=I
  640 V=J
  650 IF (I0.EQ.1) GOTO 310
  660 IF (I0.EQ.3) GOTO 850
  710 IF (S.LT..005) GOTO 510
  720 S = 2.0*A/(V+SQRT(V*V+2.0*A*(G-Z*K/M)))
  730 I0=2 
      GOTO 900
  810 W=(1.0-M*G/(Z*K))/2.0
  820 S=M*V/(Z*K*(W+SQRT(W*W+V/Z)))+ .05
  825 I0=3 
      GOTO 900
  830 IF (I.LT.0) GOTO 710
  840 GOTO 600
  850 IF (J .GT. 0.0) GOTO 310
  860 IF (V .GT. 0.0) GOTO 310
  870 GOTO 810
  900 Q=S*K/M
  905 IF (Q.GT.0) GOTO 1000
  910 J=V+G*S+Z*(-Q*(1.0+Q*(1.0/2.0+Q*(1.0/3.0+
     * Q*(1.0/4.0+Q*(1.0/5.0))))))
  920 I=A-G*S*S/2.0-V*S+Z*S*(Q*(1.0/2.0+Q*(1.0/6.0+
     * Q*(1.0/12.0+Q*(1.0/20.0+Q*(1.0/30.0))))))
  930 IF (I0.EQ.1) GOTO 360
  940 IF (I0.EQ.2) GOTO 600
  950 IF (I0.EQ.3) GOTO 830
 1000 J=V+G*S
 1010 I=A-G*S*S/2.0-V*S
 1020 GOTO 930
 9999 END

