CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      SUBROUTINE PARAM
C gets parameters from screen
C ends program on request
C closes old files
C maps menu variables to program variables
C opens new files
C calculates all derivative parameters
C performs checks on parameters
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C GLOBAL VARIABLES:
      INCLUDE 'MENU.ALL'
      INCLUDE 'IO.ALL'
      INCLUDE 'PARAM.E1'
      INCLUDE 'MAP.E1'
C LOCAL VARIABLES:
      REAL S                             ! CURRENT VALUE OF ACTION
      REAL E1                            ! CURRENT VALUE OF ENERGY
      REAL X1,X2                         ! CURRENT TURNING POINTS
C FUNCTION:
      LOGICAL LOGCVT                     ! CONVERTS 1 AND 0 TO TRUE AND FALSE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C     GET INPUT FROM TERMINAL
      CALL CLEAR
      CALL ASK(1,ISTOP)
C
C     STOP PROGRAM IF REQUESTED
      IF (MREALS(IMAIN).EQ.STOP) CALL FINISH
C
C     CLOSE FILES IF NECESSARY
      IF (TNAME.NE.MSTRNG(MINTS(ITNAME)))
     +   CALL FLCLOS(TNAME,TUNIT)
      IF (GNAME.NE.MSTRNG(MINTS(IGNAME)))
     +   CALL FLCLOS(GNAME,GUNIT)
C
C     PHYSICAL AND NUMERICAL PARAMETERS
      GAMMA=MREALS(IGAMMA)
      ETOL=MREALS(IETOL)
      XTOL=MREALS(IXTOL)
      NPTS=MINTS(INPTS)
C
C     TEXT OUTPUT PARAMETERS
      TTERM=LOGCVT(MINTS(ITTERM))
      TFILE=LOGCVT(MINTS(ITFILE))
      TNAME=MSTRNG(MINTS(ITNAME))
C
C     GRAPHICS OUTPUT PARAMETERS
      GTERM=LOGCVT(MINTS(IGTERM))
      GHRDCP=LOGCVT(MINTS(IGHRD))
      GFILE=LOGCVT(MINTS(IGFILE))
      GNAME=MSTRNG(MINTS(IGNAME))
      NGRF=MINTS(INGRF)
C
C     OPEN FILES
      IF (TFILE) CALL FLOPEN(TNAME,TUNIT)
      IF (GFILE) CALL FLOPEN(GNAME,GUNIT)
C     FILES MAY HAVE BEEN RENAMED
      MSTRNG(MINTS(ITNAME))=TNAME
      MSTRNG(MINTS(IGNAME))=GNAME
C
C     CALCULATE TOTAL NUMBER OF LEVELS
      E1=-ETOL
      CALL ACTION(E1,X1,X2,S)
      NLEVEL=INT(S/PI-.5)+1
C     CHECK VALUE OF GAMMA
      CALL PCHECK
C
      CALL CLEAR
C
      RETURN
      END

