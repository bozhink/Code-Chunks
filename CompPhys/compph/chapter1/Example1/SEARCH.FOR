CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      SUBROUTINE SEARCH(N,E1,F1,X1,X2)
C FINDS THE N'TH BOUND STATE
C E1 IS PASSED IN AS INITIAL GUESS FOR THE BOUND STATE ENERGY
C    AND RETURNED AS THE TRUE BOUND STATE ENERGY WITH TURNING POINTS
C    X1 AND X2
C F1 IS THE FUNCTION WHICH GOES TO ZERO AT ABOUND STATE
C F1 = ACTION/2-(N+1/2)*PI
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C GLOBAL VARIABLES
      INCLUDE 'PARAM.E1'
C INPUT/OUTPUT VARIABLES:
      INTEGER N                       ! CURRENT LEVEL (INPUT)
      REAL E1,E2                      ! TRIAL ENERGIES (I/O)
      REAL F1,F2                      ! F=ACTION/2-PI*(N+1/2) (I/O)
      REAL S                          ! ACTION (OUTPUT)
      REAL X1,X2                      ! TURNING POINTS (OUTPUT)
C LOCAL VARIABLES:
      REAL DE                         ! INCREMENT IN ENERGY SEARCH
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C     GUESS THE NEXT ENERGY IN ORDER TO BEGIN SEARCH
      E2=E1+ABS(E1)/4.
      DE=2*ETOL
C
C     USE SECANT SEARCH TO FIND THE BOUND STATE
   50 IF (ABS(DE).GT.ETOL) THEN
         CALL ACTION(E2,X1,X2,S)      ! S AT NEW ENERGY
         F2=S-(N+.5)*PI               ! F AT NEW ENERGY
         IF (F2.NE.F1) THEN           ! CALCULATE NEW DE
            DE=-F2*(E2-E1)/(F2-F1)
         ELSE
            DE=0.
         ENDIF
C
         E1=E2                        ! ROLL VALUES
         F1=F2
         E2=E1+DE                     ! INCREMENT ENERGY
         IF (E2.GE.0) E2=-ETOL        ! KEEP ENERGY NEGATIVE
      GOTO 50
      ENDIF
C
      RETURN
      END

